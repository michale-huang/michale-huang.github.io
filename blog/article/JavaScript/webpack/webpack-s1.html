<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack配置工程师—基础 | hh`s blog</title>
    <meta name="generator" content="VuePress 1.5.0">
    
    <meta name="description" content="hh">
    <link rel="preload" href="/blog/assets/css/0.styles.56a09861.css" as="style"><link rel="preload" href="/blog/assets/js/app.90ca3cba.js" as="script"><link rel="preload" href="/blog/assets/js/2.0a87b090.js" as="script"><link rel="preload" href="/blog/assets/js/34.ce987871.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.73161e17.js"><link rel="prefetch" href="/blog/assets/js/11.1f6589e4.js"><link rel="prefetch" href="/blog/assets/js/12.343955a5.js"><link rel="prefetch" href="/blog/assets/js/13.81f6a33a.js"><link rel="prefetch" href="/blog/assets/js/14.37002dbc.js"><link rel="prefetch" href="/blog/assets/js/15.93f700e5.js"><link rel="prefetch" href="/blog/assets/js/16.c72526c6.js"><link rel="prefetch" href="/blog/assets/js/17.044b3739.js"><link rel="prefetch" href="/blog/assets/js/18.576941cd.js"><link rel="prefetch" href="/blog/assets/js/19.14e0e4c2.js"><link rel="prefetch" href="/blog/assets/js/20.82d080af.js"><link rel="prefetch" href="/blog/assets/js/21.3d941682.js"><link rel="prefetch" href="/blog/assets/js/22.8ec49238.js"><link rel="prefetch" href="/blog/assets/js/23.4979c973.js"><link rel="prefetch" href="/blog/assets/js/24.74736046.js"><link rel="prefetch" href="/blog/assets/js/25.86dd7129.js"><link rel="prefetch" href="/blog/assets/js/26.4c76f76f.js"><link rel="prefetch" href="/blog/assets/js/27.084047a9.js"><link rel="prefetch" href="/blog/assets/js/28.25d03c47.js"><link rel="prefetch" href="/blog/assets/js/29.ca503c71.js"><link rel="prefetch" href="/blog/assets/js/3.5871bd1c.js"><link rel="prefetch" href="/blog/assets/js/30.511b830f.js"><link rel="prefetch" href="/blog/assets/js/31.b08d5570.js"><link rel="prefetch" href="/blog/assets/js/32.6c2da4ab.js"><link rel="prefetch" href="/blog/assets/js/33.0b83573b.js"><link rel="prefetch" href="/blog/assets/js/35.7a7ff244.js"><link rel="prefetch" href="/blog/assets/js/36.a2c60f1d.js"><link rel="prefetch" href="/blog/assets/js/37.9865aa64.js"><link rel="prefetch" href="/blog/assets/js/38.f6097ed4.js"><link rel="prefetch" href="/blog/assets/js/39.7d1163bf.js"><link rel="prefetch" href="/blog/assets/js/4.1ab1c1e7.js"><link rel="prefetch" href="/blog/assets/js/40.3580e053.js"><link rel="prefetch" href="/blog/assets/js/41.0414e04c.js"><link rel="prefetch" href="/blog/assets/js/42.d5fdeb3f.js"><link rel="prefetch" href="/blog/assets/js/43.1833bedf.js"><link rel="prefetch" href="/blog/assets/js/44.6eda156a.js"><link rel="prefetch" href="/blog/assets/js/45.571f45e9.js"><link rel="prefetch" href="/blog/assets/js/46.4f3f6834.js"><link rel="prefetch" href="/blog/assets/js/47.278a5068.js"><link rel="prefetch" href="/blog/assets/js/48.555e50db.js"><link rel="prefetch" href="/blog/assets/js/49.f9002c0d.js"><link rel="prefetch" href="/blog/assets/js/5.9160080f.js"><link rel="prefetch" href="/blog/assets/js/50.470b5a79.js"><link rel="prefetch" href="/blog/assets/js/6.a8c51ebe.js"><link rel="prefetch" href="/blog/assets/js/7.3d138dc9.js"><link rel="prefetch" href="/blog/assets/js/8.f4f1d018.js"><link rel="prefetch" href="/blog/assets/js/9.b85e6dad.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.56a09861.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">hh`s blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/article/JavaScript/QA-daily.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/resume.html" class="nav-link">
  Resume
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/article/JavaScript/QA-daily.html" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/blog/resume.html" class="nav-link">
  Resume
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/article/JavaScript/QA-daily.html" class="sidebar-link">每日一题  💌</a></li><li><a href="/blog/article/JavaScript/QA-advanced.html" class="sidebar-link">前端进阶问题 💥</a></li><li><a href="/blog/article/Other/curring.html" class="sidebar-link">函数柯里化 🌝</a></li><li><a href="/blog/article/JavaScript/Class.html" class="sidebar-link">Class 🌿</a></li><li><a href="/blog/article/JavaScript/weakMap.html" class="sidebar-link">WeakMap 👈</a></li><li><a href="/blog/article/JavaScript/clipboard.html" class="sidebar-link">原生JS实现粘贴到剪贴板</a></li><li><a href="/blog/article/JavaScript/browser.html" class="sidebar-link">浏览器内核与JS引擎</a></li><li><a href="/blog/article/JavaScript/webpack/webpack-s1.html" aria-current="page" class="active sidebar-link">webpack配置工程师—基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#webpack是什么？有什么作用" class="sidebar-link">webpack是什么？有什么作用</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#webpack核心概念" class="sidebar-link">webpack核心概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_1-entry" class="sidebar-link">1. entry</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_2-output" class="sidebar-link">2. output</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_3-module" class="sidebar-link">3. module</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_4-loader" class="sidebar-link">4. loader</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_5-resolve" class="sidebar-link">5. resolve</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_6-chunk" class="sidebar-link">6. chunk</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_7-plugins" class="sidebar-link">7. plugins</a></li><li class="sidebar-sub-header"><a href="/blog/article/JavaScript/webpack/webpack-s1.html#_8-webpack-dev-server" class="sidebar-link">8. webpack-dev-server</a></li></ul></li></ul></li><li><a href="/blog/article/JavaScript/webpack/webpack-s2.html" class="sidebar-link">webpack配置工程师—实践</a></li><li><a href="/blog/article/JavaScript/reconstruction/reconstruction.html" class="sidebar-link">项目重构优化了解一下</a></li><li><a href="/blog/article/JavaScript/api-rules.html" class="sidebar-link">前后端接口规范</a></li><li><a href="/blog/article/JavaScript/token.html" class="sidebar-link">聊聊token那些事</a></li><li><a href="/blog/article/JavaScript/js-tricks.html" class="sidebar-link">JavaScript中常用的小技巧</a></li><li><a href="/blog/article/JavaScript/yarn-vs-npm.html" class="sidebar-link">yarn vs npm</a></li><li><a href="/blog/article/js/http-cache.html" class="sidebar-link">http缓存</a></li><li><a href="/blog/article/js/event-loop.html" class="sidebar-link">事件循环机制</a></li><li><a href="/blog/article/js/complexity.html" class="sidebar-link">时间复杂度 &amp;&amp; 空间复杂度</a></li><li><a href="/blog/article/js/vue-react.html" class="sidebar-link">Vue vs React</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack配置工程师-基础"><a href="#webpack配置工程师-基础" class="header-anchor">#</a> webpack配置工程师—基础</h1> <h2 id="webpack是什么？有什么作用"><a href="#webpack是什么？有什么作用" class="header-anchor">#</a> webpack是什么？有什么作用</h2> <p><a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">webpack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一个模块打包工具。它将一堆文件中的每个文件都作为一个模块，找出它们的依赖关系，将它们打包为可部署的静态资源。它能做的事情包括以下：</p> <ul><li>代码转换：通过各种loader，将我们写的一些浏览器不能直接运行的扩展语言解析打包成合适的格式供浏览器使用; 比如将ES6, CoffeeScript, TypeScript转换为ES5, 将SCSS装换成CSS等;</li> <li>文件处理与优化：处理html或css中引用的图片，将其移动到配置的路径中并使用md5 hash重命名；压缩合并图片，压缩JS,CSS,HTML代码</li> <li>代码分割：提取项目中公共代码；提取首屏不需要执行的代码让其异步加载；不同页面代码按需加载</li> <li>模块合并: 在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件</li> <li>代码校验：在代码提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过，配合eslint，pre-commit</li> <li>自动刷新：监听本地源代码的变化，自动重新构建、刷新浏览器。</li> <li>自动发布：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li></ul> <p>小结一下：</p> <blockquote><p>Webpack 启动后会从 Entry 里配置的 Module 开始递归解析 Entry 依赖的所有 Module。 每找到一个 Module， 就会根据配置的Loader去找出对应的转换规则，对 Module 进行转换后，再解析出当前 Module 依赖的 Module。 这些模块会以 Entry 为单位进行分组，一个 Entry 和其所有依赖的 Module 被分到一个组也就是一个 Chunk。最后 Webpack 会把所有 Chunk 转换成文件输出。 在整个流程中 Webpack 会在恰当的时机执行 Plugin 里定义的逻辑。</p></blockquote> <h2 id="webpack核心概念"><a href="#webpack核心概念" class="header-anchor">#</a> webpack核心概念</h2> <h3 id="_1-entry"><a href="#_1-entry" class="header-anchor">#</a> 1. entry</h3> <p>webpack把整个项目当作一个整体，需要根据给定的主文件来执行构建的第一步，可以理解为入口文件，webpack会从entry开始递归找出所有依赖的模块; 可以有多个entry，每个entry对应最后生成的一个chunk；</p> <p><code>context</code>：基础目录，绝对路径。用于从配置中解析入口，默认使用当前目录，推荐传递一个值，使得配置文件独立于当前工作目录。当配置文件和入口文件不在用一层目录结构时，例如配置文件在config文件夹下，入口文件在src文件夹下，那么配置应如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    context<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/main.js'</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>最后打包出的chunk会被命名为main[hash].js</p> <p>当项目是多页面应用时配置多个入口如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    context<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        home<span class="token operator">:</span> <span class="token string">&quot;./src/home.js&quot;</span>，
        category<span class="token operator">:</span> <span class="token string">&quot;./src/category.js&quot;</span><span class="token punctuation">,</span>
        about<span class="token operator">:</span> <span class="token string">&quot;./src/about.js&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>多页面传给entry的是一个对象，最终打包出的各个chunk名称分别是该对象的key</p> <h3 id="_2-output"><a href="#_2-output" class="header-anchor">#</a> 2. output</h3> <p>输出结果。webpack经过一系列处理并得到最终输出结果，output可配置如何输出最终打包的文件以及在哪里输出bundle、assets等，entry可以有多个但只能指定一个output配置</p> <p><code>publicPath</code>： 公共路径，为所有静态资源（css,image,js）提供一个基础路径，这个基础路径要配合具体资源中指定的路径一起使用，简单来说就是：</p> <blockquote><p>静态资源最终访问路径 = output.publicPath + 资源loader或plugins配置的路径</p></blockquote> <p>例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>output<span class="token punctuation">.</span>publicPath <span class="token operator">=</span> <span class="token string">'/'</span>

<span class="token comment">// image</span>
modele<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'static/img/[name].[hash:7].[ext]'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 最终图片访问地址</span>
output<span class="token punctuation">.</span>publicPath <span class="token operator">+</span> <span class="token string">'static/img/[name].[hash:7].[ext]'</span> <span class="token operator">=</span> <span class="token string">'/dist/static/img/[name].[hash:7].[ext]'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>一般情况下publicPath是以'/'结尾，而其他loader或插件的配置不要以'/'开头</p> <p>当<code>output.publicPath</code>设置为相对路径后，是相对于build后的index.html的;</p> <p>如果将静态资源托管到cdn上，则需要使用其他URL比如相对于协议的</p> <p><code>publicPath: &quot;https://cdn.example.com/assets/&quot;</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 输出目录的绝对路径</span>
        publicPath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].[hash].bundle.js'</span><span class="token punctuation">,</span> <span class="token comment">//使用入口名称和每次构建的唯一hash</span>
        chunkFilename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span> <span class="token comment">// 非入口chunk的名称</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_3-module"><a href="#_3-module" class="header-anchor">#</a> 3. module</h3> <p>在webpack中一切皆模块，即所有格式的文件（.html, .css, .js, .png, .jpg...）都是一个模块，一个文件则对应一个模块</p> <p>关于module的配置是用于处理项目中的不同模块的，主要配置在rules中。</p> <p><code>noParse</code>: 可用于忽略解析某些与正则相匹配的文件，而忽略一些大型的library可提高构建性能，比如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token function-variable function">noParse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">/</span>jquery<span class="token operator">|</span>lodash<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token comment">//忽略jquery文件解析，直接编译打包</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>忽略的文件中不应包含import，require等任何导入机制</p> <p><code>rules</code>: 创建模块时，匹配请求的规则，这些规则能够修改模块的创建方式、对模块应用loaders、修改解析器;</p> <p>每条rule分为三部分:</p> <ul><li><p>condititon条件:</p> <p>condition包括两类：被请求的资源(resource)和资源请求者(issuer); 属性<code>test</code>, <code>include</code>, <code>exclude</code> 和 <code>resource</code> 是针对被请求资源的，<code>issuer</code>是针对资源请求者的</p></li> <li><p>result结果:</p> <p>只有在condition匹配的情况下result才会起作用</p> <p>resule有两种配置：loader和parse</p></li> <li><p>nested-rule嵌套条件</p> <p>用于在condition匹配时进行取值，可以使用<code>rules</code>和<code>oneOf</code>来指定规则</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">noParse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">/</span>jquery<span class="token operator">|</span>lodash<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span> <span class="token comment">// 绝对路径符合该正则的则满足条件需要走这个规则</span>
            include<span class="token operator">:</span> <span class="token punctuation">[</span>
                path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span> <span class="token comment">// 指定该目录中文件需要走这个规则</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            exclude<span class="token operator">:</span> <span class="token punctuation">[</span>
                path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app/demo'</span><span class="token punctuation">)</span> <span class="token comment">// 排除该目录中文件，不需要走该规则</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token string">'css-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            resource<span class="token operator">:</span> <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
                include<span class="token operator">:</span> <span class="token punctuation">[</span>
                    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token punctuation">[</span>
                    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app/demo'</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            issure<span class="token operator">:</span> <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
                include<span class="token operator">:</span> <span class="token punctuation">[</span>
                    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token punctuation">[</span>
                    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app/demo'</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token string">'css-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            test<span class="token operator">:</span> <span class="token regex">/\.(png|jpeg|gif|svg)$/</span><span class="token punctuation">,</span>
            oneOf<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
                resourceQuery<span class="token operator">:</span> <span class="token regex">/one/</span><span class="token punctuation">,</span>
                loader<span class="token operator">:</span> <span class="token string">'url-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                loader<span class="token operator">:</span> <span class="token string">'file-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>上面rules中两条其实是一样的效果，只是不同写法，后者只是将<code>test</code>,<code>include</code>,<code>exclude</code>包装成了一个对象放在resource或issuer中</p> <p>第三条rule中<code>oneOf</code>表示对该资源只应用第一个规则，<code>resourceQuery</code>针对的是&quot;?&quot;后面的路径参数，比如：</p> <p>path/to/foo.png?one: 会匹配url-loader</p> <p>path/to/foo.png?two:会匹配file-loader</p> <p>path/to/foo.png: 会匹配file-loader</p> <h3 id="_4-loader"><a href="#_4-loader" class="header-anchor">#</a> 4. loader</h3> <p>模块转化器，将原模块内容按要求转换为新的内容; 上文已有介绍</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token string">'css-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token string">'vue-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_5-resolve"><a href="#_5-resolve" class="header-anchor">#</a> 5. resolve</h3> <p>resolve能够设置模块如何被解析</p> <p><code>alias</code>：创建 <code>import</code>和 <code>require</code>的别名来使模块导入更加简单，比如</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>modules<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
        Utils<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/utilities/'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Templates<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/templates/'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 配置前</span>
<span class="token keyword">import</span> Utility <span class="token keyword">from</span> <span class="token string">'../../utils/utility'</span><span class="token punctuation">;</span>
<span class="token comment">// 配置后</span>
<span class="token keyword">import</span> Utility <span class="token keyword">from</span> <span class="token string">'Utils/utility'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>enforceExtension</code>：Boolean, 当值为false时引用时不需要扩展名</p> <p><code>modules</code>：告诉webpack解析模块时候应该搜索的目录</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>modules<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">]</span> <span class="token comment">//搜索时src目录会有优先于node_modules</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-chunk"><a href="#_6-chunk" class="header-anchor">#</a> 6. chunk</h3> <p>代码块，一个代码块由多个模块组成，用于将代码拆分合并；</p> <p>代码分离是webpack最引人注目的地方之一，该特性可以将代码分离到不同的bundle中，然后按需加载或者并行加载这些bundle，以及控制加载的优先级，这将极大影响加载时间，提升性能。</p> <h3 id="_7-plugins"><a href="#_7-plugins" class="header-anchor">#</a> 7. plugins</h3> <p>插件可以说是webpack的支柱，webpack本身就是一个复杂度较高的插件集合,利用其插件机制构建出来的；使用各种plugins，可以使得webpack在构建流程的特定时机注入扩展逻辑并执行相应操作从而改变构建结果；</p> <p>举个例子：<code>HtmlWebpackPlugin</code>（自动为html引用打包后的文件）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span> <span class="token comment">// to access webpack build-in plugins</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">// extra installed via package manager</span>
 <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// a build-in plugin, use UglifyJs to compress/beautifier your js</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><a href="/blog/article/JavaScript/webpack/webpack-s2.html#插件">更多常用插件实践戳这里</a></p> <h3 id="_8-webpack-dev-server"><a href="#_8-webpack-dev-server" class="header-anchor">#</a> 8. webpack-dev-server</h3> <p>在开发阶段，利用webpack-dev-server启动一个本地的node服务器进行开发，webpack-dev-server打包的内容是放在内存中的，至于打包后的资源对外的的根目录就是上文提到过的<code>publicPath</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>modules<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//指定本地服务器在哪里寻找资源，dist目录将作为可访问文件</span>
        compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否压缩文件</span>
        port<span class="token operator">:</span> <span class="token number">9000</span><span class="token punctuation">,</span> <span class="token comment">//开发测试端口号</span>
        hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否启用热更新</span>
        open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否自动打开浏览器</span>
        proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000&quot;</span> <span class="token comment">// 设置代理url, 请求到 /api/users 现在会被代理到请求 http://localhost:3000/api/users</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/article/JavaScript/browser.html" class="prev">
        浏览器内核与JS引擎
      </a></span> <span class="next"><a href="/blog/article/JavaScript/webpack/webpack-s2.html">
        webpack配置工程师—实践
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.90ca3cba.js" defer></script><script src="/blog/assets/js/2.0a87b090.js" defer></script><script src="/blog/assets/js/34.ce987871.js" defer></script>
  </body>
</html>
